# üè† Zadarma Gate Control Bot

Telegram –±–æ—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Ö–≤—ñ—Ä—Ç–∫–æ—é —Ç–∞ –≤–æ—Ä–æ—Ç–∞–º–∏ —á–µ—Ä–µ–∑ Zadarma API.

## üöÄ –®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç

### 1. –ö–ª–æ–Ω—É–≤–∞–Ω–Ω—è –ø—Ä–æ—î–∫—Ç—É
```bash
git clone https://github.com/YOUR_USERNAME/zadarma-bot.git
cd zadarma-bot
```

### 2. –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó
```bash
# –°–∫–æ–ø—ñ—é–π—Ç–µ —à–∞–±–ª–æ–Ω –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó
cp config.py.example config.py

# –í—ñ–¥—Ä–µ–¥–∞–≥—É–π—Ç–µ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é –∑ –≤–∞—à–∏–º–∏ —Ä–µ–∞–ª—å–Ω–∏–º–∏ –¥–∞–Ω–Ω–∏–º–∏
nano config.py
```

### 3. –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π
```bash
# –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è Python –ø–∞–∫–µ—Ç—ñ–≤
pip3 install -r requirements.txt
```

### 4. –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –±–∞–∑–∏ –¥–∞–Ω–∏—Ö
–ë–∞–∑–∞ –¥–∞–Ω–∏—Ö SQLite —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø—Ä–∏ –ø–µ—Ä—à–æ–º—É –∑–∞–ø—É—Å–∫—É.

### 5. –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
```bash
# –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç
./run_script.sh

# –ê–±–æ –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ
python3 bot.py
```

## ‚öôÔ∏è –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è

–ó–∞–ø–æ–≤–Ω—ñ—Ç—å —Ñ–∞–π–ª `config.py` –Ω–∞—Å—Ç—É–ø–Ω–∏–º–∏ –¥–∞–Ω–Ω–∏–º–∏:

### Telegram Bot
- `TELEGRAM_TOKEN` - —Ç–æ–∫–µ–Ω –≤—ñ–¥ @BotFather
- `ADMIN_USER_ID` - –≤–∞—à Telegram User ID

### Zadarma API
- `ZADARMA_API_KEY` - –∫–ª—é—á API –∑ –∫–∞–±—ñ–Ω–µ—Ç—É Zadarma
- `ZADARMA_API_SECRET` - —Å–µ–∫—Ä–µ—Ç–Ω–∏–π –∫–ª—é—á API
- `ZADARMA_SIP_ACCOUNT` - –≤–∞—à SIP –∞–∫–∫–∞—É–Ω—Ç
- `ZADARMA_MAIN_PHONE` - –æ—Å–Ω–æ–≤–Ω–∏–π –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω—É
- `HVIRTKA_NUMBER` - –Ω–æ–º–µ—Ä —Ö–≤—ñ—Ä—Ç–∫–∏
- `VOROTA_NUMBER` - –Ω–æ–º–µ—Ä –≤–æ—Ä—ñ—Ç

### WLaunch API (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)
- `WLAUNCH_API_KEY` - –∫–ª—é—á WLaunch API
- `COMPANY_ID` - ID –∫–æ–º–ø–∞–Ω—ñ—ó –≤ WLaunch

### SMS Fly (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)
- `SMS_FLY_LOGIN` - –ª–æ–≥—ñ–Ω SMS Fly
- `SMS_FLY_PASSWORD` - –ø–∞—Ä–æ–ª—å SMS Fly
- `SMS_FLY_SENDER` - —ñ–º'—è –≤—ñ–¥–ø—Ä–∞–≤–Ω–∏–∫–∞

## üîß –û–±—Å–ª—É–≥–æ–≤—É–≤–∞–Ω–Ω—è

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω—ñ —Å–∫—Ä–∏–ø—Ç–∏
- `daily_maintenance.sh` - —â–æ–¥–µ–Ω–Ω–µ –æ–±—Å–ª—É–≥–æ–≤—É–≤–∞–Ω–Ω—è
- `api_check.sh` - –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ API
- `check_and_run_bot.sh` - –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ç–∞ –∑–∞–ø—É—Å–∫ –±–æ—Ç–∞

### –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥
```bash
# –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É –≤—Å—ñ—Ö API
./api_check.sh

# –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–±–æ—Ç–∏ –±–æ—Ç–∞
./check_and_run_bot.sh

# –î–µ–Ω–Ω–µ –æ–±—Å–ª—É–≥–æ–≤—É–≤–∞–Ω–Ω—è
./daily_maintenance.sh
```

### –õ–æ–≥–∏
- `bot.log` - –ª–æ–≥–∏ —Ä–æ–±–æ—Ç–∏ –±–æ—Ç–∞
- `webhook_processor.log` - –ª–æ–≥–∏ webhook –æ–±—Ä–æ–±–Ω–∏–∫–∞
- `maintenance.log` - –ª–æ–≥–∏ –æ–±—Å–ª—É–≥–æ–≤—É–≤–∞–Ω–Ω—è

## üîó Webhook –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

### PHP webhook —Ñ–∞–π–ª–∏ –≤ –ø–∞–ø—Ü—ñ `webhooks/`:
- `zadarma_webhook.php` - –æ—Å–Ω–æ–≤–Ω–∏–π webhook –¥–ª—è Zadarma
- `zadarma_ivr_webhook_fixed.php` - IVR webhook
- `gomonclinic_webhook.php` - webhook –¥–ª—è –∫–ª—ñ–Ω—ñ–∫–∏

### –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –≤ Zadarma:
1. –ó–∞–π–¥—ñ—Ç—å –≤ –∫–∞–±—ñ–Ω–µ—Ç Zadarma
2. API -> Webhooks
3. –î–æ–¥–∞–π—Ç–µ URL: `https://–≤–∞—à-–¥–æ–º–µ–Ω.com/webhooks/zadarma_webhook.php`

## üì± –ö–æ–º–∞–Ω–¥–∏ –±–æ—Ç–∞

### –î–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤:
- `/start` - –ø–æ—á–∞—Ç–æ–∫ —Ä–æ–±–æ—Ç–∏ –∑ –±–æ—Ç–æ–º
- `/hvirtka` - –≤—ñ–¥–∫—Ä–∏—Ç–∏ —Ö–≤—ñ—Ä—Ç–∫—É
- `/vorota` - –≤—ñ–¥–∫—Ä–∏—Ç–∏ –≤–æ—Ä–æ—Ç–∞
- `/info` - —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –∫–ª—ñ–Ω—ñ–∫—É
- `/map` - –∫–∞—Ä—Ç–∞ –ø—Ä–æ—ó–∑–¥—É
- `/help` - –¥–æ–ø–æ–º–æ–≥–∞

### –î–ª—è –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä—ñ–≤:
- `/admin` - –ø–∞–Ω–µ–ª—å –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞
- `/stats` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è
- `/users` - —Å–ø–∏—Å–æ–∫ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
- `/sync` - —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è –∑ WLaunch

## üõ†Ô∏è –†–æ–∑—Ä–æ–±–∫–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É
```
zadarma-bot/
‚îú‚îÄ‚îÄ bot.py                 # –ì–æ–ª–æ–≤–Ω–∏–π —Ñ–∞–π–ª –±–æ—Ç–∞
‚îú‚îÄ‚îÄ config.py.example      # –®–∞–±–ª–æ–Ω –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó
‚îú‚îÄ‚îÄ zadarma_api.py         # Zadarma API
‚îú‚îÄ‚îÄ zadarma_api_webhook.py # Webhook –æ–±—Ä–æ–±–∫–∞
‚îú‚îÄ‚îÄ wlaunch_api.py         # WLaunch API
‚îú‚îÄ‚îÄ user_db.py             # –†–æ–±–æ—Ç–∞ –∑ –±–∞–∑–æ—é –¥–∞–Ω–∏—Ö
‚îú‚îÄ‚îÄ auth.py                # –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è
‚îú‚îÄ‚îÄ utils.py               # –î–æ–ø–æ–º—ñ–∂–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó
‚îú‚îÄ‚îÄ process_webhook.py     # –û–±—Ä–æ–±–Ω–∏–∫ webhook
‚îú‚îÄ‚îÄ webhooks/              # PHP webhook —Ñ–∞–π–ª–∏
‚îú‚îÄ‚îÄ reports/               # –î–µ–Ω–Ω—ñ –∑–≤—ñ—Ç–∏
‚îî‚îÄ‚îÄ requirements.txt       # Python –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ
```

### –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è
```bash
# –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è —Ñ–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è –Ω–æ–º–µ—Ä—ñ–≤
python3 config.py

# –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è webhook
python3 process_webhook.py '{"event":"NOTIFY_END","caller_id":"test"}'
```

## üîí –ë–µ–∑–ø–µ–∫–∞

- ‚úÖ –ö–æ–Ω—Ñ—ñ–¥–µ–Ω—Ü—ñ–π–Ω—ñ –¥–∞–Ω—ñ –≤ `config.py` –Ω–µ –∫–æ–º–º—ñ—Ç—è—Ç—å—Å—è –≤ Git
- ‚úÖ API –∫–ª—é—á—ñ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –ª–æ–∫–∞–ª—å–Ω–æ
- ‚úÖ –õ–æ–≥–∏ –Ω–µ –º—ñ—Å—Ç—è—Ç—å —á—É—Ç–ª–∏–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó
- ‚úÖ Webhook –∑–∞—Ö–∏—â–µ–Ω–∏–π –≤—ñ–¥ –∑–ª–æ–≤–º–∏—Å–Ω–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤

## üìû –ü—ñ–¥—Ç—Ä–∏–º–∫–∞

–ü—Ä–∏ –≤–∏–Ω–∏–∫–Ω–µ–Ω–Ω—ñ –ø—Ä–æ–±–ª–µ–º –∑–≤–µ—Ä–Ω—ñ—Ç—å—Å—è –¥–æ:
- –¢–µ–ª–µ—Ñ–æ–Ω: `SUPPORT_PHONE` –∑ config.py
- Email: admin@example.com
- Telegram: @admin

## üìÑ –õ—ñ—Ü–µ–Ω–∑—ñ—è

MIT License - –¥–µ—Ç–∞–ª—å–Ω—ñ—à–µ –≤ —Ñ–∞–π–ª—ñ LICENSE.
